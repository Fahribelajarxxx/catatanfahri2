<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fahri Sage Inventory</title>
    <!-- Font Premium: Playfair Display & Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* SAGE GREEN PALETTE */
            --sage-dark: #4A6C6F;
            --sage-primary: #84A98C;
            --sage-light: #CAD2C5;
            --sage-bg: #F3F4F3;
            --sage-white: #FFFFFF;
            
            --accent: #D68C45; /* Earthy Orange for contrast */
            --text-main: #2F3E46;
            --text-muted: #8F9E9E;
            
            --radius-lg: 24px;
            --radius-md: 16px;
            --shadow-soft: 0 10px 40px -10px rgba(74, 108, 111, 0.15);
            --shadow-card: 0 4px 20px rgba(0,0,0,0.03);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--sage-bg);
            color: var(--text-main);
            /* Background Pattern Halus */
            background-image: radial-gradient(var(--sage-light) 1px, transparent 1px);
            background-size: 20px 20px;
            padding-bottom: 100px;
            overflow-x: hidden;
        }

        /* --- HEADER --- */
        .header {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 25px 20px;
            padding-top: 40px;
            position: sticky;
            top: 0;
            z-index: 50;
            border-bottom: 1px solid rgba(255,255,255,0.5);
        }

        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .brand-title { font-family: 'Playfair Display', serif; font-size: 1.5rem; color: var(--sage-dark); }
        
        .income-card {
            background: linear-gradient(135deg, var(--sage-dark), var(--sage-primary));
            padding: 24px;
            border-radius: var(--radius-lg);
            color: white;
            box-shadow: var(--shadow-soft);
            position: relative;
            overflow: hidden;
        }
        
        /* Dekorasi lingkaran di income card */
        .income-card::before {
            content: '';
            position: absolute;
            top: -20px; right: -20px;
            width: 100px; height: 100px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }

        .income-label { font-size: 0.85rem; opacity: 0.9; letter-spacing: 1px; text-transform: uppercase; }
        .income-value { font-family: 'Playfair Display', serif; font-size: 2rem; margin-top: 5px; font-weight: 700; }

        /* --- LIST --- */
        .list-container { padding: 20px; }

        .card {
            background: var(--sage-white);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: var(--shadow-card);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            border: 1px solid rgba(255,255,255,0.5);
            position: relative;
            overflow: hidden;
        }

        .card:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0,0,0,0.05); }
        .card:active { transform: scale(0.98); }

        /* Border Kiri Berdasarkan Status */
        .card[data-status="siap"] { border-left: 4px solid var(--sage-primary); }
        .card[data-status="belum"] { border-left: 4px solid var(--accent); }

        .card-top { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
        .item-name { font-weight: 600; font-size: 1.05rem; color: var(--text-main); }
        
        .status-badge {
            font-size: 0.7rem;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        .badge-siap { background: #E8F5E9; color: #2E7D32; } /* Hijau Soft */
        .badge-belum { background: #FFF3E0; color: #EF6C00; } /* Oranye Soft */

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #eee;
        }

        .info-label { font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
        .info-val { font-size: 1rem; font-weight: 600; color: var(--sage-dark); }
        .price-text { color: var(--accent); font-weight: 700; font-size: 1.1rem; }

        .action-btn {
            margin-top: 15px;
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-ready { background: var(--sage-light); color: var(--sage-dark); }
        .btn-ready:hover { background: var(--sage-primary); color: white; }
        
        .btn-undo { background: #f5f5f5; color: var(--text-muted); }
        .btn-undo:hover { background: #e0e0e0; }

        .btn-delete { 
            background: transparent; color: #EF5350; width: auto; padding: 8px; margin-left: 10px;
            font-size: 0.8rem;
        }

        /* --- FAB --- */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 64px;
            height: 64px;
            background: var(--sage-dark);
            border-radius: 50%;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 0 15px 35px rgba(74, 108, 111, 0.4);
            border: none;
            cursor: pointer;
            z-index: 100;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .fab:hover { transform: scale(1.1) rotate(90deg); }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(47, 62, 70, 0.4);
            backdrop-filter: blur(8px);
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .modal-overlay.open { display: flex; animation: fadeIn 0.3s ease; }

        .modal-card {
            background: white;
            width: 100%;
            max-width: 400px;
            border-radius: 30px;
            padding: 30px;
            box-shadow: var(--shadow-soft);
            transform: scale(0.9);
            animation: popUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popUp { to { transform: scale(1); } }

        .form-group { margin-bottom: 20px; }
        .form-label { display: block; font-size: 0.85rem; font-weight: 600; color: var(--sage-dark); margin-bottom: 8px; }
        
        .form-input, .form-select {
            width: 100%;
            padding: 14px;
            border: 2px solid #EDF1F0;
            border-radius: 14px;
            font-size: 1rem;
            background: #FAFBFB;
            color: var(--text-main);
            outline: none;
            transition: all 0.3s;
        }
        .form-input:focus, .form-select:focus { border-color: var(--sage-primary); background: white; }

        .btn-submit {
            width: 100%;
            padding: 16px;
            background: var(--sage-dark);
            color: white;
            border: none;
            border-radius: 14px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(74, 108, 111, 0.3);
        }
        .btn-cancel {
            width: 100%;
            padding: 12px;
            background: transparent;
            color: var(--text-muted);
            border: none;
            margin-top: 10px;
            font-weight: 500;
            cursor: pointer;
        }

        /* --- CONFETTI CANVAS --- */
        #confetti { position: fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:999; }
        
        /* Empty State */
        .empty-box { text-align: center; padding: 60px 20px; color: var(--text-muted); }
        .empty-icon { font-size: 4rem; margin-bottom: 20px; opacity: 0.5; display: block; }
    </style>
</head>
<body>

    <!-- Header -->
    <div class="header">
        <div class="header-top">
            <div class="brand-title">Fahri Collection</div>
            <div style="background:white; padding:8px; border-radius:50%; font-size:1.2rem;">üåø</div>
        </div>
        <div class="income-card">
            <div class="income-label">Total Revenue</div>
            <div class="income-value" id="total-income">Rp 0</div>
        </div>
    </div>

    <!-- List -->
    <div class="list-container" id="card-list">
        <!-- Items injected here -->
    </div>

    <div id="empty-box" class="empty-box" style="display:none;">
        <span class="empty-icon">üçÇ</span>
        <h3>Kosong Melompong</h3>
        <p>Mulai catat pesanan sekarang ya.</p>
    </div>

    <!-- FAB -->
    <button class="fab" onclick="openModal()">+</button>

    <!-- Modal Form -->
    <div class="modal-overlay" id="modal">
        <div class="modal-card">
            <h2 style="font-family:'Playfair Display'; color:var(--sage-dark); margin-bottom:25px; text-align:center;">Catat Baru</h2>
            <form id="myForm">
                <div class="form-group">
                    <label class="form-label">Nama Baju</label>
                    <input type="text" id="inName" class="form-input" placeholder="Contoh: Tunik Sage" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Kategori Ukuran</label>
                    <select id="inSize" class="form-select">
                        <optgroup label="üë∂ Anak (Per Tahun)">
                            <option value="1 Thn">1 Tahun</option>
                            <option value="2 Thn">2 Tahun</option>
                            <option value="3 Thn">3 Tahun</option>
                            <option value="4 Thn">4 Tahun</option>
                            <option value="5 Thn">5 Tahun</option>
                            <option value="6 Thn">6 Tahun</option>
                            <option value="7 Thn">7 Tahun</option>
                            <option value="8 Thn">8 Tahun</option>
                            <option value="9 Thn">9 Tahun</option>
                            <option value="10 Thn">10 Tahun</option>
                            <option value="11 Thn">11 Tahun</option>
                            <option value="12 Thn">12 Tahun</option>
                        </optgroup>
                        <optgroup label="üßç Dewasa (Standar)">
                            <option value="S">Ukuran S</option>
                            <option value="M" selected>Ukuran M</option>
                            <option value="L">Ukuran L</option>
                            <option value="XL">Ukuran XL</option>
                            <option value="XXL">Ukuran XXL</option>
                        </optgroup>
                        <optgroup label="üìè Lainnya">
                            <option value="All Size">All Size</option>
                            <option value="Custom">Custom</option>
                        </optgroup>
                    </select>
                </div>

                <!-- Harga Input (Sudah tidak ada Komisi, full width) -->
                <div class="form-group">
                    <label class="form-label">Harga</label>
                    <input type="number" id="inPrice" class="form-input" placeholder="0" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Status Awal</label>
                    <div style="display:flex; gap:10px; background:#EDF1F0; padding:5px; border-radius:12px;">
                        <label style="flex:1; text-align:center; padding:10px; cursor:pointer; border-radius:8px; font-weight:600; font-size:0.9rem;" id="lbl-belum">
                            <input type="radio" name="stat" value="belum" checked> Belum
                        </label>
                        <label style="flex:1; text-align:center; padding:10px; cursor:pointer; border-radius:8px; font-weight:600; font-size:0.9rem;" id="lbl-siap">
                            <input type="radio" name="stat" value="siap"> Siap
                        </label>
                    </div>
                </div>

                <button type="submit" class="btn-submit">Simpan</button>
                <button type="button" class="btn-cancel" onclick="closeModal()">Batal</button>
            </form>
        </div>
    </div>

    <canvas id="confetti"></canvas>

    <script>
        let items = JSON.parse(localStorage.getItem('fahriSageAppV2')) || [];
        const listEl = document.getElementById('card-list');
        const emptyEl = document.getElementById('empty-box');
        const modal = document.getElementById('modal');
        const totalEl = document.getElementById('total-income');

        function formatRp(num) {
            return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', maximumFractionDigits: 0 }).format(num);
        }

        function save() {
            localStorage.setItem('fahriSageAppV2', JSON.stringify(items));
            render();
        }

        function render() {
            listEl.innerHTML = '';
            let total = 0;

            // Sort: Siap dulu, lalu Belum, lalu terbaru
            items.sort((a, b) => {
                if (a.status === 'siap' && b.status !== 'siap') return -1;
                if (a.status !== 'siap' && b.status === 'siap') return 1;
                return b.id - a.id;
            });

            if(items.length === 0) emptyEl.style.display = 'block';
            else emptyEl.style.display = 'none';

            items.forEach((item, i) => {
                // Hitung income HANYA jika status SIAP
                if(item.status === 'siap') {
                    total += parseInt(item.price);
                }

                const isSiap = item.status === 'siap';
                const badgeClass = isSiap ? 'badge-siap' : 'badge-belum';
                const badgeText = isSiap ? 'Siap ‚Ä¢ Lunas' : 'Belum Siap';
                const btnText = isSiap ? '‚Ü© Kembalikan' : '‚ú® Tandai Siap';
                const btnClass = isSiap ? 'btn-undo' : 'btn-ready';
                
                // Style Card Border
                const statusAttr = isSiap ? 'siap' : 'belum';

                const div = document.createElement('div');
                div.className = 'card';
                div.setAttribute('data-status', statusAttr);
                // Animasi masuk
                div.style.animation = `slideUp 0.4s ease forwards ${i*0.05}s`;
                div.style.opacity = '0'; // Mulai transparan

                div.innerHTML = `
                    <div class="card-top">
                        <span class="item-name">${item.name}</span>
                        <span class="status-badge ${badgeClass}">${badgeText}</span>
                    </div>
                    <div class="info-row">
                        <div>
                            <div class="info-label">Ukuran</div>
                            <div class="info-val">${item.size}</div>
                        </div>
                        <div style="text-align:right;">
                            <div class="info-label">Harga Jual</div>
                            <div class="price-text">${formatRp(item.price)}</div>
                        </div>
                    </div>
                    <div style="margin-top:15px; display:flex; align-items:center;">
                        <button class="action-btn ${btnClass}" onclick="toggleStatus(${item.id})">
                            ${btnText}
                        </button>
                        <button class="action-btn btn-delete" onclick="del(${item.id})">üóëÔ∏è</button>
                    </div>
                `;
                listEl.appendChild(div);
            });

            // Animate Number
            totalEl.textContent = formatRp(total);
        }

        // --- ACTIONS ---
        document.getElementById('myForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const newItem = {
                id: Date.now(),
                name: document.getElementById('inName').value,
                size: document.getElementById('inSize').value,
                price: document.getElementById('inPrice').value,
                status: document.querySelector('input[name="stat"]:checked').value
            };
            items.unshift(newItem); // Add to top
            save();
            closeModal();
            e.target.reset();
            // Reset Size Select
            document.getElementById('inSize').value = 'M';
            showToast('Data tersimpan');
        });

        window.toggleStatus = function(id) {
            const item = items.find(i => i.id === id);
            if(item) {
                const oldStatus = item.status;
                item.status = item.status === 'siap' ? 'belum' : 'siap';
                save();
                
                if(oldStatus === 'belum' && item.status === 'siap') {
                    fireConfetti();
                    showToast('Pesanan Selesai! üéâ');
                }
            }
        };

        window.del = function(id) {
            if(confirm('Hapus catatan ini?')) {
                items = items.filter(i => i.id !== id);
                save();
            }
        };

        // --- UI UTILS ---
        window.openModal = () => { modal.classList.add('open'); };
        window.closeModal = () => { modal.classList.remove('open'); };
        modal.addEventListener('click', (e) => { if(e.target === modal) closeModal(); });

        // Custom Radio Logic
        const radios = document.querySelectorAll('input[name="stat"]');
        radios.forEach(r => {
            r.addEventListener('change', (e) => {
                document.getElementById('lbl-belum').style.background = e.target.value === 'belum' ? '#fff' : 'transparent';
                document.getElementById('lbl-siap').style.background = e.target.value === 'siap' ? '#fff' : 'transparent';
            });
        });

        function showToast(msg) {
            const t = document.createElement('div');
            t.textContent = msg;
            t.style.cssText = `position:fixed; top:20px; left:50%; transform:translateX(-50%); background:#2F3E46; color:white; padding:10px 20px; border-radius:30px; z-index:999; font-size:0.9rem; animation:fadeIn 0.3s;`;
            document.body.appendChild(t);
            setTimeout(() => { t.style.opacity='0'; setTimeout(()=>t.remove(),300); }, 2000);
        }

        // --- CONFETTI ENGINE ---
        const canvas = document.getElementById('confetti');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];

        function fireConfetti() {
            for(let i=0; i<60; i++) {
                particles.push({
                    x: window.innerWidth/2,
                    y: window.innerHeight/1.5,
                    vx: (Math.random()-0.5)*15,
                    vy: (Math.random()-1.5)*15,
                    color: `hsl(${Math.random()*60 + 80}, 70%, 60%)`, // Sage/Green/Yellow hues
                    life: 100,
                    size: Math.random()*6+2
                });
            }
            animateConfetti();
        }

        function animateConfetti() {
            ctx.clearRect(0,0, canvas.width, canvas.height);
            particles.forEach((p, idx) => {
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.5; // gravity
                p.life--;
                ctx.fillStyle = p.color;
                ctx.fillRect(p.x, p.y, p.size, p.size);
                if(p.life <= 0) particles.splice(idx, 1);
            });
            if(particles.length > 0) requestAnimationFrame(animateConfetti);
        }
        window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });

        // Init
        render();

        // Add keyframe for slideUp dynamically
        const styleSheet = document.createElement("style");
        styleSheet.innerText = `@keyframes slideUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }`;
        document.head.appendChild(styleSheet);

    </script>
</body>
</html>